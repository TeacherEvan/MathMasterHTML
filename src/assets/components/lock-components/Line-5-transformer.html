<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Level 5 Lock Transformer - Ultimate Metamorphosis</title>
    <link rel="stylesheet" href="/src/styles/css/lock-components/Line-5-transformer.css">
</head>
</head>

<body>
    <div class="controls">
    </div>

    <div class="lock-container">
        <!-- Main Lock Body (Starting from Level 4's final state) -->
        <div class="lock-body" id="lockBody">
            <!-- Core Element -->
            <div class="core" id="core"></div>

            <!-- Detachable Segments -->
            <div class="detachable-segment segment-nw" id="segmentNW"></div>
            <div class="detachable-segment segment-ne" id="segmentNE"></div>
            <div class="detachable-segment segment-sw" id="segmentSW"></div>
            <div class="detachable-segment segment-se" id="segmentSE"></div>

            <!-- Static Electric Currents -->
            <div class="electric-current current-to-nw" id="currentNW"></div>
            <div class="electric-current current-to-ne" id="currentNE"></div>
            <div class="electric-current current-to-sw" id="currentSW"></div>
            <div class="electric-current current-to-se" id="currentSE"></div>

            <!-- Enhanced Energy Arcs (From Level 4, now blue) -->
            <div class="energy-arc arc-north" id="arcNorth"></div>
            <div class="energy-arc arc-south" id="arcSouth"></div>
            <div class="energy-arc arc-east" id="arcEast"></div>
            <div class="energy-arc arc-west" id="arcWest"></div>

            <!-- Particle System -->
            <div class="particle" id="particle1"></div>
            <div class="particle" id="particle2"></div>
            <div class="particle" id="particle3"></div>
            <div class="particle" id="particle4"></div>
            <div class="particle" id="particle5"></div>
            <div class="particle" id="particle6"></div>
            <div class="particle" id="particle7"></div>
            <div class="particle" id="particle8"></div>
        </div>

    </div>

    <script>
        class Level5Lock {
            constructor() {
                this.isActive = false;
                this.currentPhase = 0;
                this.totalPhases = 6;
                this.detachedSegments = 0;

                this.elements = {
                    lockBody: document.getElementById('lockBody'),
                    core: document.getElementById('core'),
                    statusDisplay: document.getElementById('statusDisplay'),
                    segments: {
                        nw: document.getElementById('segmentNW'),
                        ne: document.getElementById('segmentNE'),
                        sw: document.getElementById('segmentSW'),
                        se: document.getElementById('segmentSE')
                    },
                    currents: {
                        nw: document.getElementById('currentNW'),
                        ne: document.getElementById('currentNE'),
                        sw: document.getElementById('currentSW'),
                        se: document.getElementById('currentSE')
                    },
                    arcs: {
                        north: document.getElementById('arcNorth'),
                        south: document.getElementById('arcSouth'),
                        east: document.getElementById('arcEast'),
                        west: document.getElementById('arcWest')
                    },
                    particles: []
                };

                // Initialize particles
                for (let i = 1; i <= 8; i++) {
                    this.elements.particles.push(document.getElementById(`particle${i}`));
                }

                this.bindEvents();
            }

            bindEvents() {
                document.addEventListener('keydown', (e) => {
                    if (e.key === '5') {
                        this.activate();
                    } else if (e.key.toLowerCase() === 'r') {
                        this.reset();
                    }
                });
            }

            activate() {
                if (this.isActive) return;

                console.log('ðŸ”µ Level 5 Ultimate Metamorphosis: Static Electric Detachment Initiated');
                this.isActive = true;
                this.currentPhase = 1;

                // Phase 1: Core transformation and status display (0-1s)
                setTimeout(() => this.phase1_CoreTransformation(), 100);

                // Phase 2: Segment emergence (1-2s)
                setTimeout(() => this.phase2_SegmentEmergence(), 1000);

                // Phase 3: Static electric currents activation (2-3s)
                setTimeout(() => this.phase3_ElectricCurrents(), 2000);

                // Phase 4: Segment detachment (3-4s)
                setTimeout(() => this.phase4_SegmentDetachment(), 3000);

                // Phase 5: Enhanced energy arcs (4-5s)
                setTimeout(() => this.phase5_EnergyArcs(), 4000);

                // Phase 6: Particle system activation (5s+)
                setTimeout(() => this.phase6_ParticleSystem(), 5000);
            }

            phase1_CoreTransformation() {
                console.log('âš¡ Phase 1: Core Blue Energy Transformation');
                this.currentPhase = 1;
                this.elements.lockBody.classList.add('active');
                this.elements.core.classList.add('active');
                this.elements.statusDisplay.classList.add('active');
            }

            phase2_SegmentEmergence() {
                console.log('ðŸ”§ Phase 2: Detachable Segments Emergence');
                this.currentPhase = 2;

                Object.values(this.elements.segments).forEach((segment, index) => {
                    setTimeout(() => {
                        segment.classList.add('active');
                    }, index * 200);
                });
            }

            phase3_ElectricCurrents() {
                console.log('âš¡ Phase 3: Static Electric Currents Activation');
                this.currentPhase = 3;

                Object.values(this.elements.currents).forEach((current, index) => {
                    setTimeout(() => {
                        current.classList.add('active');
                    }, index * 150);
                });
            }

            phase4_SegmentDetachment() {
                console.log('ðŸš€ Phase 4: Segment Detachment with Electric Tethering');
                this.currentPhase = 4;

                const segmentKeys = ['nw', 'ne', 'sw', 'se'];
                segmentKeys.forEach((key, index) => {
                    setTimeout(() => {
                        this.elements.segments[key].classList.add('detached');
                        this.detachedSegments++;
                        console.log(`   Segment ${key.toUpperCase()} detached (${this.detachedSegments}/4)`);
                    }, index * 300);
                });
            }

            phase5_EnergyArcs() {
                console.log('ðŸŒ€ Phase 5: Enhanced Blue Energy Arc Discharge');
                this.currentPhase = 5;

                Object.values(this.elements.arcs).forEach((arc, index) => {
                    setTimeout(() => {
                        arc.classList.add('active');
                    }, index * 200);
                });
            }

            phase6_ParticleSystem() {
                console.log('âœ¨ Phase 6: Ultimate Particle System Activation');
                this.currentPhase = 6;

                this.elements.particles.forEach((particle, index) => {
                    setTimeout(() => {
                        particle.classList.add('active');
                        particle.style.animationDelay = `${index * 0.2}s`;
                    }, index * 100);
                });

                console.log('ðŸŽ‰ Level 5 Ultimate Metamorphosis: COMPLETE - Static Electric Mastery Achieved!');
            }

            reset() {
                console.log('ðŸ”„ Level 5 Reset: Returning to Level 4 final state');
                this.isActive = false;
                this.currentPhase = 0;
                this.detachedSegments = 0;

                // Remove all active classes
                this.elements.lockBody.classList.remove('active');
                this.elements.core.classList.remove('active');
                this.elements.statusDisplay.classList.remove('active');

                Object.values(this.elements.segments).forEach(segment => {
                    segment.classList.remove('active', 'detached');
                });

                Object.values(this.elements.currents).forEach(current => {
                    current.classList.remove('active');
                });

                Object.values(this.elements.arcs).forEach(arc => {
                    arc.classList.remove('active');
                });

                this.elements.particles.forEach(particle => {
                    particle.classList.remove('active');
                });
            }

            getStatus() {
                return {
                    isActive: this.isActive,
                    currentPhase: this.currentPhase,
                    totalPhases: this.totalPhases,
                    detachedSegments: this.detachedSegments,
                    phaseNames: [
                        'Inactive',
                        'Core Transformation',
                        'Segment Emergence',
                        'Electric Currents',
                        'Segment Detachment',
                        'Energy Arc Discharge',
                        'Particle System'
                    ]
                };
            }

            getCurrentPhase() {
                return this.currentPhase;
            }

            getDetachedSegments() {
                return this.detachedSegments;
            }

            isFullyDetached() {
                return this.detachedSegments === 4;
            }
        }

        // Initialize Level 5 Lock
        const level5Lock = new Level5Lock();

        // Make it globally accessible for integration
        window.Level5Lock = {
            activate: () => level5Lock.activate(),
            reset: () => level5Lock.reset(),
            getStatus: () => level5Lock.getStatus(),
            isActive: () => level5Lock.isActive,
            getCurrentPhase: () => level5Lock.getCurrentPhase(),
            getDetachedSegments: () => level5Lock.getDetachedSegments(),
            isFullyDetached: () => level5Lock.isFullyDetached()
        };

        console.log('ðŸ”µ Level 5 Lock Transformer Initialized - Ultimate Metamorphosis Ready');
        console.log('Press "5" to activate, "R" to reset');
    </script>
</body>

</html>